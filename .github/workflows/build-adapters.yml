name: Build All Adapters

on:
  push:
    branches: [ master, main, develop ]
  pull_request:
    branches: [ master, main, develop ]
  schedule:
    # Runs every day at 2:00 AM UTC
    - cron: '0 2 * * *'
  workflow_dispatch:

jobs:
  build-applovin:
    name: Build AppLovin Adapter
    runs-on: macos-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/AppLovin"
          pod install
      
      - name: Build AppLovin Adapter
        run: |
          cd "Adapters/AppLovin"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISAppLovinAdapter.xcworkspace \
            -scheme ISAppLovinAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-bidmachine:
    name: Build BidMachine Adapter
    runs-on: macos-latest
    needs: build-applovin
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/BidMachine"
          pod install
      
      - name: Build BidMachine Adapter
        run: |
          cd "Adapters/BidMachine"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISBidMachineAdapter.xcworkspace \
            -scheme ISBidMachineAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-bigo:
    name: Build Bigo Adapter
    runs-on: macos-latest
    needs: build-bidmachine
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Bigo"
          pod install
      
      - name: Build Bigo Adapter
        run: |
          cd "Adapters/Bigo"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISBigoAdapter.xcworkspace \
            -scheme ISBigoAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-chartboost:
    name: Build Chartboost Adapter
    runs-on: macos-latest
    needs: build-bigo
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Chartboost"
          pod install
      
      - name: Build Chartboost Adapter
        run: |
          cd "Adapters/Chartboost"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISChartboostAdapter.xcworkspace \
            -scheme ISChartboostAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-facebook:
    name: Build Facebook Adapter
    runs-on: macos-latest
    needs: build-chartboost
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Facebook"
          pod install
      
      - name: Build Facebook Adapter
        run: |
          cd "Adapters/Facebook"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISFacebookAdapter.xcworkspace \
            -scheme ISFacebookAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-admob:
    name: Build AdMob Adapter
    runs-on: macos-latest
    needs: build-facebook
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Google (AdMob and Ad Manager)"
          pod install
      
      - name: Build AdMob Adapter
        run: |
          cd "Adapters/Google (AdMob and Ad Manager)"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISAdMobAdapter.xcworkspace \
            -scheme ISAdMobAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-inmobi:
    name: Build InMobi Adapter
    runs-on: macos-latest
    needs: build-admob
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/InMobi"
          pod install
      
      - name: Build InMobi Adapter
        run: |
          cd "Adapters/InMobi"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISInMobiAdapter.xcworkspace \
            -scheme ISInMobiAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-line:
    name: Build Line Adapter
    runs-on: macos-latest
    needs: build-inmobi
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Line"
          pod install
      
      - name: Build Line Adapter
        run: |
          cd "Adapters/Line"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISLineAdapter.xcworkspace \
            -scheme ISLineAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-mobilefuse:
    name: Build MobileFuse Adapter
    runs-on: macos-latest
    needs: build-line
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/MobileFuse"
          pod install
      
      - name: Build MobileFuse Adapter
        run: |
          cd "Adapters/MobileFuse"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISMobileFuseAdapter.xcworkspace \
            -scheme ISMobileFuseAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-moloco:
    name: Build Moloco Adapter
    runs-on: macos-latest
    needs: build-mobilefuse
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Moloco"
          pod install
      
      - name: Build Moloco Adapter
        run: |
          cd "Adapters/Moloco"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISMolocoAdapter.xcworkspace \
            -scheme ISMolocoAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-ogury:
    name: Build Ogury Adapter
    runs-on: macos-latest
    needs: build-moloco
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Ogury"
          pod install
      
      - name: Build Ogury Adapter
        run: |
          cd "Adapters/Ogury"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISOguryAdapter.xcworkspace \
            -scheme ISOguryAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-pangle:
    name: Build Pangle Adapter
    runs-on: macos-latest
    needs: build-ogury
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Pangle"
          pod install
      
      - name: Build Pangle Adapter
        run: |
          cd "Adapters/Pangle"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISPangleAdapter.xcworkspace \
            -scheme ISPangleAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-pubmatic:
    name: Build PubMatic Adapter
    runs-on: macos-latest
    needs: build-pangle
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/PubMatic"
          pod install
      
      - name: Build PubMatic Adapter
        run: |
          cd "Adapters/PubMatic"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISPubMaticAdapter.xcworkspace \
            -scheme ISPubMaticAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-unityads:
    name: Build UnityAds Adapter
    runs-on: macos-latest
    needs: build-pubmatic
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/UnityAds"
          pod install
      
      - name: Build UnityAds Adapter
        run: |
          cd "Adapters/UnityAds"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISUnityAdsAdapter.xcworkspace \
            -scheme ISUnityAdsAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-verve:
    name: Build Verve Adapter
    runs-on: macos-latest
    needs: build-unityads
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Verve"
          pod install
      
      - name: Build Verve Adapter
        run: |
          cd "Adapters/Verve"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISVerveAdapter.xcworkspace \
            -scheme ISVerveAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-vungle:
    name: Build Vungle Adapter
    runs-on: macos-latest
    needs: build-verve
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Vungle"
          pod install
      
      - name: Build Vungle Adapter
        run: |
          cd "Adapters/Vungle"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISVungleAdapter.xcworkspace \
            -scheme ISVungleAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-yandex:
    name: Build Yandex Adapter
    runs-on: macos-latest
    needs: build-vungle
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/Yandex"
          pod install
      
      - name: Build Yandex Adapter
        run: |
          cd "Adapters/Yandex"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISYandexAdapter.xcworkspace \
            -scheme ISYandexAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  build-yso:
    name: Build YSO Adapter
    runs-on: macos-latest
    needs: build-yandex
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Xcode
        uses: maxim-lobanov/setup-xcode@v1
        with:
          xcode-version: latest-stable
      
      - name: Install CocoaPods
        run: |
          cd "Adapters/YSO"
          pod install
      
      - name: Build YSO Adapter
        run: |
          cd "Adapters/YSO"
          export RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1
          xcodebuild -workspace ISYSOAdapter.xcworkspace \
            -scheme ISYSOAdapter \
            -configuration Release \
            -sdk iphonesimulator \
            clean build \
            CODE_SIGNING_ALLOWED=NO \
            RW_MULTIPLATFORM_BUILD_IN_PROGRESS=1 \
            ONLY_ACTIVE_ARCH=NO

  all-builds-success:
    name: All Builds Successful
    runs-on: ubuntu-latest
    needs: 
      - build-applovin
      - build-bidmachine
      - build-bigo
      - build-chartboost
      - build-facebook
      - build-admob
      - build-inmobi
      - build-line
      - build-mobilefuse
      - build-moloco
      - build-ogury
      - build-pangle
      - build-pubmatic
      - build-unityads
      - build-verve
      - build-vungle
      - build-yandex
      - build-yso
    steps:
      - name: All builds passed
        run: echo "âœ… All adapter builds completed successfully!"

